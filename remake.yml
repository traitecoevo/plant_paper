packages:
  - rmarkdown
  - tree

sources:
  - R

plot_options:
  wide:
    width: 12
    height: 4
  square:
    width: 8
    height: 8
  med_square:
    width: 10
    height: 10
  large_square:
    width: 12
    height: 12

targets:
  all:
    depends:
      - ms.pdf
      - tree_demography.pdf

  ms.pdf:
    command: pandoc_build("ms.md", "template.tex")
    depends:
      - refs.bib
      - downloads/style.csl
      - output/empty.pdf
      - output/plant.pdf
      - output/patch.pdf
      - output/fitness.pdf

  downloads/style.csl:
    download: https://raw.githubusercontent.com/citation-style-language/styles/master/methods-in-ecology-and-evolution.csl

  output/empty.pdf:
    command: empty_box()
    plot: square

  tree_demography.pdf:
    command: pandoc_build("tree_demography.md", "template.tex", toc=TRUE)
    depends:
      - refs.bib
      - downloads/style.csl

  tree_demography.md:
    knitr: TRUE

  tree_physiology.pdf:
    command: pandoc_build("tree_physiology.md", "template.tex", toc=TRUE)
    depends:
      - refs.bib
      - downloads/style.csl

  tree_physiology.md:
    knitr: TRUE
    depends:
      - refs.bib
      - downloads/style.csl

  fitness_landscape_data:
    command: make_fitness_data()

  growth_data:
    command: make_growth_data()

  output/plant.pdf:
    command: figure_plant()
    plot: true

  output/fitness.pdf:
    command: figure_fitness_landscape(fitness_landscape_data)
    plot: true

  output/patch.pdf:
    command: figure_growth(growth_data)
    plot: true
